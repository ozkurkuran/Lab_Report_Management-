<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Report Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .nav {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .nav-btn {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .nav-btn:hover {
            background: #e9ecef;
            color: #667eea;
        }

        .nav-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 150px;
            font-family: monospace;
        }

        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-success {
            background: #28a745;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .list-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 4px solid #667eea;
            cursor: pointer;
            transition: all 0.2s;
        }

        .list-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .list-item h4 {
            color: #495057;
            margin-bottom: 5px;
        }

        .list-item p {
            color: #6c757d;
            font-size: 14px;
        }

        .tag {
            display: inline-block;
            padding: 4px 12px;
            background: #667eea;
            color: white;
            border-radius: 12px;
            font-size: 12px;
            margin-right: 5px;
            margin-top: 5px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-card h2 {
            font-size: 2.5em;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
        }

        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .api-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background: #28a745;
            color: white;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .api-status.offline {
            background: #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <div style="flex: 1;"></div>
                <div style="flex: 1; text-align: center;">
                    <h1 style="margin: 0;">üî¨ <span id="header-title">Lab Report Management System</span></h1>
                </div>
                <div style="flex: 1; text-align: right;">
                    <button onclick="toggleLanguage()" style="background: rgba(255,255,255,0.2); border: 2px solid white; color: white; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                        <span id="lang-btn">üáπüá∑ TR</span>
                    </button>
                </div>
            </div>
            <p id="header-subtitle">Laboratuvar G√ºnl√ºk ve Rapor Y√∂netim Sistemi</p>
            <p style="font-size: 0.9em; opacity: 0.8; margin-top: 8px;">
                <span id="header-company">Mikrofab ≈üirketi tarafƒ±ndan ara≈ütƒ±rmacƒ±lar i√ßin geli≈ütirilmi≈ütir</span>
            </p>
        </div>

        <div class="nav">
            <button class="nav-btn active" onclick="showTab('dashboard')">üìä <span class="nav-text" data-tr="Dashboard" data-en="Dashboard">Dashboard</span></button>
            <button class="nav-btn" onclick="showTab('projects')">üìÅ <span class="nav-text" data-tr="Projeler" data-en="Projects">Projeler</span></button>
            <button class="nav-btn" onclick="showTab('experiments')">üß™ <span class="nav-text" data-tr="Deneyler" data-en="Experiments">Deneyler</span></button>
            <button class="nav-btn" onclick="showTab('entries')">üìù <span class="nav-text" data-tr="Kayƒ±tlar" data-en="Entries">Kayƒ±tlar</span></button>
            <button class="nav-btn" onclick="showTab('search')">üîç <span class="nav-text" data-tr="Arama" data-en="Search">Arama</span></button>
            <button class="nav-btn" onclick="showTab('api')">‚öôÔ∏è <span class="nav-text" data-tr="API Dok√ºmanlarƒ±" data-en="API Docs">API Dok√ºmanlarƒ±</span></button>
        </div>

        <div class="content">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <h2>Dashboard</h2>
                <div class="stats" id="stats">
                    <div class="stat-card">
                        <h2 id="stat-projects">-</h2>
                        <p>Projeler</p>
                    </div>
                    <div class="stat-card">
                        <h2 id="stat-experiments">-</h2>
                        <p>Deneyler</p>
                    </div>
                    <div class="stat-card">
                        <h2 id="stat-entries">-</h2>
                        <p>Kayƒ±tlar</p>
                    </div>
                    <div class="stat-card">
                        <h2 id="stat-attachments">-</h2>
                        <p>Dosyalar</p>
                    </div>
                </div>

                <div class="card">
                    <h3>Son Eklenen Kayƒ±tlar</h3>
                    <div id="recent-entries"></div>
                </div>
            </div>

            <!-- Projects Tab -->
            <div id="projects" class="tab-content">
                <h2>Projeler</h2>
                <div class="card">
                    <h3>Yeni Proje Olu≈ütur</h3>
                    <form id="project-form">
                        <div class="form-group">
                            <label>Proje Adƒ±</label>
                            <input type="text" id="project-name" required placeholder="√ñrn: YBCO ƒ∞nce Film Karakterizasyonu">
                        </div>
                        <div class="form-group">
                            <label>A√ßƒ±klama</label>
                            <textarea id="project-description" placeholder="Proje hakkƒ±nda detaylar..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Etiketler (virg√ºlle ayƒ±rƒ±n)</label>
                            <input type="text" id="project-tags" placeholder="√ñrn: YBCO, s√ºperiletken, ince film">
                        </div>
                        <button type="submit" class="btn">Proje Olu≈ütur</button>
                    </form>
                </div>

                <div class="card">
                    <h3>Mevcut Projeler</h3>
                    <div id="projects-list"></div>
                </div>
            </div>

            <!-- Experiments Tab -->
            <div id="experiments" class="tab-content">
                <h2>Deneyler</h2>
                <div class="card">
                    <h3>Yeni Deney Olu≈ütur</h3>
                    <form id="experiment-form">
                        <div class="form-group">
                            <label>Proje Se√ßin</label>
                            <select id="experiment-project" required></select>
                        </div>
                        <div class="form-group">
                            <label>Deney Ba≈ülƒ±ƒüƒ±</label>
                            <input type="text" id="experiment-title" required placeholder="√ñrn: 77K Van der Pauw √ñl√ß√ºmleri">
                        </div>
                        <div class="form-group">
                            <label>A√ßƒ±klama</label>
                            <textarea id="experiment-description"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Etiketler</label>
                            <input type="text" id="experiment-tags" placeholder="√ñrn: VDP, 77K, diren√ß">
                        </div>
                        <button type="submit" class="btn">Deney Olu≈ütur</button>
                    </form>
                </div>

                <div class="card">
                    <h3>Mevcut Deneyler</h3>
                    <div id="experiments-list"></div>
                </div>
            </div>

            <!-- Entries Tab -->
            <div id="entries" class="tab-content">
                <h2>G√ºnl√ºk Kayƒ±tlarƒ±</h2>
                <div class="card">
                    <h3>Yeni Kayƒ±t Olu≈ütur</h3>
                    <form id="entry-form">
                        <div class="form-group">
                            <label>Deney Se√ßin</label>
                            <select id="entry-experiment" required></select>
                        </div>
                        <div class="form-group">
                            <label>Ba≈ülƒ±k</label>
                            <input type="text" id="entry-title" required placeholder="√ñrn: G√ºnl√ºk - 2025-10-07">
                        </div>
                        <div class="form-group">
                            <label>ƒ∞√ßerik (Markdown)</label>
                            <textarea id="entry-body" placeholder="## Deney Ko≈üullarƒ±&#10;- Sƒ±caklƒ±k: 77K&#10;- Manyetik Alan: 0.5T&#10;&#10;## Sonu√ßlar&#10;..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Etiketler</label>
                            <input type="text" id="entry-tags" placeholder="√ñrn: YBCO, VDP, 77K">
                        </div>
                        <button type="submit" class="btn">Kayƒ±t Olu≈ütur</button>
                    </form>
                </div>

                <div class="card">
                    <h3>Mevcut Kayƒ±tlar</h3>
                    <div id="entries-list"></div>
                </div>
            </div>

            <!-- Search Tab -->
            <div id="search" class="tab-content">
                <h2>Arama</h2>
                <div class="card">
                    <h3>Kayƒ±tlarda Ara</h3>
                    <div class="form-group">
                        <label>Arama Metni</label>
                        <input type="text" id="search-text" placeholder="Ba≈ülƒ±k veya i√ßerikte ara...">
                    </div>
                    <div class="form-group">
                        <label>Etiketler</label>
                        <input type="text" id="search-tags" placeholder="Virg√ºlle ayƒ±rƒ±n">
                    </div>
                    <button onclick="performSearch()" class="btn">Ara</button>
                </div>

                <div class="card">
                    <h3>Arama Sonu√ßlarƒ±</h3>
                    <div id="search-results"></div>
                </div>
            </div>

            <!-- API Tab -->
            <div id="api" class="tab-content">
                <h2>API Dok√ºmantasyonu</h2>
                <div class="card">
                    <h3>API Adresleri</h3>
                    <p><strong>Backend URL:</strong> <a href="http://localhost:8000" target="_blank">http://localhost:8000</a></p>
                    <p><strong>Swagger UI:</strong> <a href="http://localhost:8000/docs" target="_blank">http://localhost:8000/docs</a></p>
                    <p><strong>Health Check:</strong> <a href="http://localhost:8000/health" target="_blank">http://localhost:8000/health</a></p>
                </div>

                <div class="card">
                    <h3>Hƒ±zlƒ± Ba≈ülangƒ±√ß</h3>
                    <pre style="background: #f8f9fa; padding: 15px; border-radius: 6px; overflow-x: auto;">
cd backend
python scripts\seed_data.py
python -m uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
                    </pre>
                </div>

                <div class="card">
                    <h3>API Endpoint'leri</h3>
                    <ul>
                        <li><strong>GET /api/projects/</strong> - Projeleri listele</li>
                        <li><strong>POST /api/projects/</strong> - Yeni proje</li>
                        <li><strong>GET /api/experiments/</strong> - Deneyleri listele</li>
                        <li><strong>POST /api/experiments/</strong> - Yeni deney</li>
                        <li><strong>GET /api/entries/</strong> - Kayƒ±tlarƒ± listele</li>
                        <li><strong>POST /api/entries/</strong> - Yeni kayƒ±t</li>
                        <li><strong>GET /api/search/entries?text=...</strong> - Arama</li>
                        <li><strong>POST /api/attachments/</strong> - Dosya y√ºkle</li>
                        <li><strong>POST /api/datasets/import</strong> - Dataset i√ße aktar</li>
                        <li><strong>POST /api/reports/docx</strong> - DOCX rapor √ºret</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="api-status" id="api-status">üî¥ <span id="api-status-text">Baƒülanƒ±yor...</span></div>

    <script>
        const API_URL = 'http://localhost:8000';
        let currentUserId = 1; // Demo user
        let currentLang = 'tr'; // Default language

        // Translation dictionary
        const translations = {
            tr: {
                headerTitle: 'Laboratuvar Rapor Y√∂netim Sistemi',
                headerSubtitle: 'Laboratuvar G√ºnl√ºk ve Rapor Y√∂netim Sistemi',
                headerCompany: 'Mikrofab ≈üirketi tarafƒ±ndan ara≈ütƒ±rmacƒ±lar i√ßin geli≈ütirilmi≈ütir',
                apiConnecting: 'Baƒülanƒ±yor...',
                apiOnline: 'API √áalƒ±≈üƒ±yor',
                apiOffline: 'API Offline',
                dashboard: 'Dashboard',
                projects: 'Projeler',
                experiments: 'Deneyler',
                entries: 'Kayƒ±tlar',
                search: 'Arama',
                apiDocs: 'API Dok√ºmanlarƒ±',
                statProjects: 'Projeler',
                statExperiments: 'Deneyler',
                statEntries: 'Kayƒ±tlar',
                statAttachments: 'Dosyalar',
                recentEntries: 'Son Eklenen Kayƒ±tlar',
                createProject: 'Yeni Proje Olu≈ütur',
                projectName: 'Proje Adƒ±',
                projectNamePlaceholder: '√ñrn: YBCO ƒ∞nce Film Karakterizasyonu',
                description: 'A√ßƒ±klama',
                descriptionPlaceholder: 'Proje hakkƒ±nda detaylar...',
                tags: 'Etiketler (virg√ºlle ayƒ±rƒ±n)',
                tagsPlaceholder: '√ñrn: YBCO, s√ºperiletken, ince film',
                btnCreate: 'Proje Olu≈ütur',
                currentProjects: 'Mevcut Projeler',
                noProjects: 'Hen√ºz proje yok. Yukarƒ±dan yeni proje olu≈üturun.',
                createExperiment: 'Yeni Deney Olu≈ütur',
                selectProject: 'Proje Se√ßin',
                selectPlaceholder: 'Se√ßin...',
                experimentTitle: 'Deney Ba≈ülƒ±ƒüƒ±',
                experimentPlaceholder: '√ñrn: 77K Van der Pauw √ñl√ß√ºmleri',
                btnCreateExperiment: 'Deney Olu≈ütur',
                currentExperiments: 'Mevcut Deneyler',
                noExperiments: 'Hen√ºz deney yok.',
                createEntry: 'Yeni Kayƒ±t Olu≈ütur',
                selectExperiment: 'Deney Se√ßin',
                entryTitle: 'Ba≈ülƒ±k',
                entryPlaceholder: '√ñrn: G√ºnl√ºk - 2025-10-07',
                entryContent: 'ƒ∞√ßerik (Markdown)',
                entryContentPlaceholder: '## Deney Ko≈üullarƒ±\n- Sƒ±caklƒ±k: 77K\n- Manyetik Alan: 0.5T\n\n## Sonu√ßlar\n...',
                btnCreateEntry: 'Kayƒ±t Olu≈ütur',
                currentEntries: 'Mevcut Kayƒ±tlar',
                noEntries: 'Hen√ºz kayƒ±t yok.',
                version: 'Versiyon',
                showContent: 'ƒ∞√ßeriƒüi G√∂ster',
                searchInEntries: 'Kayƒ±tlarda Ara',
                searchText: 'Arama Metni',
                searchTextPlaceholder: 'Ba≈ülƒ±k veya i√ßerikte ara...',
                searchTags: 'Etiketler',
                searchTagsPlaceholder: 'Virg√ºlle ayƒ±rƒ±n',
                btnSearch: 'Ara',
                searchResults: 'Arama Sonu√ßlarƒ±',
                noResults: 'Sonu√ß bulunamadƒ±.',
                apiDocumentation: 'API Dok√ºmantasyonu',
                apiAddresses: 'API Adresleri',
                quickStart: 'Hƒ±zlƒ± Ba≈ülangƒ±√ß',
                apiEndpoints: 'API Endpoint\'leri',
                successCreate: 'ba≈üarƒ±yla olu≈üturuldu!',
                errorOccurred: 'Hata olu≈ütu',
                connectionError: 'Baƒülantƒ± hatasƒ±',
                pleaseEnterSearch: 'L√ºtfen arama metni veya etiket girin',
                noDescription: 'A√ßƒ±klama yok'
            },
            en: {
                headerTitle: 'Lab Report Management System',
                headerSubtitle: 'Laboratory Notebook and Report Management System',
                headerCompany: 'Developed for researchers by Mikrofab company',
                apiConnecting: 'Connecting...',
                apiOnline: 'API Online',
                apiOffline: 'API Offline',
                dashboard: 'Dashboard',
                projects: 'Projects',
                experiments: 'Experiments',
                entries: 'Entries',
                search: 'Search',
                apiDocs: 'API Docs',
                statProjects: 'Projects',
                statExperiments: 'Experiments',
                statEntries: 'Entries',
                statAttachments: 'Files',
                recentEntries: 'Recent Entries',
                createProject: 'Create New Project',
                projectName: 'Project Name',
                projectNamePlaceholder: 'e.g., YBCO Thin Film Characterization',
                description: 'Description',
                descriptionPlaceholder: 'Project details...',
                tags: 'Tags (comma separated)',
                tagsPlaceholder: 'e.g., YBCO, superconductor, thin film',
                btnCreate: 'Create Project',
                currentProjects: 'Current Projects',
                noProjects: 'No projects yet. Create one above.',
                createExperiment: 'Create New Experiment',
                selectProject: 'Select Project',
                selectPlaceholder: 'Select...',
                experimentTitle: 'Experiment Title',
                experimentPlaceholder: 'e.g., 77K Van der Pauw Measurements',
                btnCreateExperiment: 'Create Experiment',
                currentExperiments: 'Current Experiments',
                noExperiments: 'No experiments yet.',
                createEntry: 'Create New Entry',
                selectExperiment: 'Select Experiment',
                entryTitle: 'Title',
                entryPlaceholder: 'e.g., Daily Log - 2025-10-07',
                entryContent: 'Content (Markdown)',
                entryContentPlaceholder: '## Experiment Conditions\n- Temperature: 77K\n- Magnetic Field: 0.5T\n\n## Results\n...',
                btnCreateEntry: 'Create Entry',
                currentEntries: 'Current Entries',
                noEntries: 'No entries yet.',
                version: 'Version',
                showContent: 'Show Content',
                searchInEntries: 'Search in Entries',
                searchText: 'Search Text',
                searchTextPlaceholder: 'Search in title or content...',
                searchTags: 'Tags',
                searchTagsPlaceholder: 'Comma separated',
                btnSearch: 'Search',
                searchResults: 'Search Results',
                noResults: 'No results found.',
                apiDocumentation: 'API Documentation',
                apiAddresses: 'API Addresses',
                quickStart: 'Quick Start',
                apiEndpoints: 'API Endpoints',
                successCreate: 'created successfully!',
                errorOccurred: 'Error occurred',
                connectionError: 'Connection error',
                pleaseEnterSearch: 'Please enter search text or tags',
                noDescription: 'No description'
            }
        };

        // Language toggle function
        function toggleLanguage() {
            currentLang = currentLang === 'tr' ? 'en' : 'tr';
            localStorage.setItem('lang', currentLang);
            updateLanguage();
        }

        // Update all text elements
        function updateLanguage() {
            const t = translations[currentLang];
            
            // Header
            document.getElementById('header-title').textContent = t.headerTitle;
            document.getElementById('header-subtitle').textContent = t.headerSubtitle;
            document.getElementById('header-company').textContent = t.headerCompany;
            document.getElementById('lang-btn').textContent = currentLang === 'tr' ? 'üá¨üáß EN' : 'üáπüá∑ TR';
            
            // Nav buttons
            document.querySelectorAll('.nav-text').forEach(el => {
                el.textContent = el.getAttribute(`data-${currentLang}`);
            });
            
            // Update content based on active tab
            updateContentLanguage();
        }

        // Update content text
        function updateContentLanguage() {
            const t = translations[currentLang];
            
            // Dashboard
            const statLabels = document.querySelectorAll('.stat-card p');
            if (statLabels.length > 0) {
                statLabels[0].textContent = t.statProjects;
                statLabels[1].textContent = t.statExperiments;
                statLabels[2].textContent = t.statEntries;
                statLabels[3].textContent = t.statAttachments;
            }
            
            // Update labels and placeholders (will be done when forms are rendered)
        }

        // Check API status
        async function checkApiStatus() {
            const t = translations[currentLang];
            try {
                const response = await fetch(`${API_URL}/health`);
                if (response.ok) {
                    document.getElementById('api-status').textContent = 'üü¢ ' + t.apiOnline;
                    document.getElementById('api-status').classList.remove('offline');
                    return true;
                }
            } catch (error) {
                document.getElementById('api-status').textContent = 'üî¥ ' + t.apiOffline;
                document.getElementById('api-status').classList.add('offline');
            }
            return false;
        }

        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Load data when tab is opened
            if (tabName === 'dashboard') loadDashboard();
            if (tabName === 'projects') loadProjects();
            if (tabName === 'experiments') loadExperiments();
            if (tabName === 'entries') loadEntries();
        }

        // Load dashboard stats
        async function loadDashboard() {
            try {
                const [projects, experiments, entries, attachments] = await Promise.all([
                    fetch(`${API_URL}/api/projects/`).then(r => r.json()),
                    fetch(`${API_URL}/api/experiments/`).then(r => r.json()),
                    fetch(`${API_URL}/api/entries/`).then(r => r.json()),
                    fetch(`${API_URL}/api/attachments/`).then(r => r.json())
                ]);

                document.getElementById('stat-projects').textContent = projects.length;
                document.getElementById('stat-experiments').textContent = experiments.length;
                document.getElementById('stat-entries').textContent = entries.length;
                document.getElementById('stat-attachments').textContent = attachments.length;

                // Show recent entries
                const recentDiv = document.getElementById('recent-entries');
                recentDiv.innerHTML = entries.slice(0, 5).map(entry => `
                    <div class="list-item">
                        <h4>${entry.title}</h4>
                        <p>Versiyon: ${entry.version} | ${new Date(entry.created_at).toLocaleString('tr-TR')}</p>
                        ${entry.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                `).join('');
            } catch (error) {
                console.error('Dashboard y√ºkleme hatasƒ±:', error);
            }
        }

        // Load projects
        async function loadProjects() {
            try {
                const projects = await fetch(`${API_URL}/api/projects/`).then(r => r.json());
                const listDiv = document.getElementById('projects-list');
                
                if (projects.length === 0) {
                    listDiv.innerHTML = '<p style="color: #6c757d;">Hen√ºz proje yok. Yukarƒ±dan yeni proje olu≈üturun.</p>';
                    return;
                }

                listDiv.innerHTML = projects.map(project => `
                    <div class="list-item">
                        <h4>${project.name}</h4>
                        <p>${project.description || 'A√ßƒ±klama yok'}</p>
                        ${project.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                `).join('');

                // Update experiment form dropdown
                const select = document.getElementById('experiment-project');
                select.innerHTML = '<option value="">Se√ßin...</option>' + 
                    projects.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
            } catch (error) {
                console.error('Proje y√ºkleme hatasƒ±:', error);
            }
        }

        // Load experiments
        async function loadExperiments() {
            try {
                const experiments = await fetch(`${API_URL}/api/experiments/`).then(r => r.json());
                const listDiv = document.getElementById('experiments-list');
                
                if (experiments.length === 0) {
                    listDiv.innerHTML = '<p style="color: #6c757d;">Hen√ºz deney yok.</p>';
                    return;
                }

                listDiv.innerHTML = experiments.map(exp => `
                    <div class="list-item">
                        <h4>${exp.title}</h4>
                        <p>${exp.description || 'A√ßƒ±klama yok'}</p>
                        ${exp.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                `).join('');

                // Update entry form dropdown
                const select = document.getElementById('entry-experiment');
                select.innerHTML = '<option value="">Se√ßin...</option>' + 
                    experiments.map(e => `<option value="${e.id}">${e.title}</option>`).join('');
            } catch (error) {
                console.error('Deney y√ºkleme hatasƒ±:', error);
            }
        }

        // Load entries
        async function loadEntries() {
            try {
                const entries = await fetch(`${API_URL}/api/entries/`).then(r => r.json());
                const listDiv = document.getElementById('entries-list');
                
                if (entries.length === 0) {
                    listDiv.innerHTML = '<p style="color: #6c757d;">Hen√ºz kayƒ±t yok.</p>';
                    return;
                }

                listDiv.innerHTML = entries.map(entry => `
                    <div class="list-item">
                        <h4>${entry.title}</h4>
                        <p>Versiyon: ${entry.version} | ${new Date(entry.created_at).toLocaleString('tr-TR')}</p>
                        ${entry.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        <details style="margin-top: 10px;">
                            <summary style="cursor: pointer; color: #667eea; font-weight: 600;">ƒ∞√ßeriƒüi G√∂ster</summary>
                            <pre style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin-top: 10px; white-space: pre-wrap;">${entry.body_md}</pre>
                        </details>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Kayƒ±t y√ºkleme hatasƒ±:', error);
            }
        }

        // Search
        async function performSearch() {
            const text = document.getElementById('search-text').value;
            const tags = document.getElementById('search-tags').value;
            
            if (!text && !tags) {
                alert('L√ºtfen arama metni veya etiket girin');
                return;
            }

            try {
                let url = `${API_URL}/api/search/entries?`;
                if (text) url += `text=${encodeURIComponent(text)}&`;
                if (tags) url += `tags=${encodeURIComponent(tags)}`;

                const results = await fetch(url).then(r => r.json());
                const resultsDiv = document.getElementById('search-results');

                if (results.length === 0) {
                    resultsDiv.innerHTML = '<p style="color: #6c757d;">Sonu√ß bulunamadƒ±.</p>';
                    return;
                }

                resultsDiv.innerHTML = results.map(entry => `
                    <div class="list-item">
                        <h4>${entry.title}</h4>
                        <p>Versiyon: ${entry.version} | ${new Date(entry.created_at).toLocaleString('tr-TR')}</p>
                        ${entry.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                `).join('');
            } catch (error) {
                console.error('Arama hatasƒ±:', error);
                alert('Arama sƒ±rasƒ±nda hata olu≈ütu');
            }
        }

        // Form submissions
        document.getElementById('project-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('project-name').value,
                description: document.getElementById('project-description').value,
                tags: document.getElementById('project-tags').value.split(',').map(t => t.trim()).filter(t => t),
                created_by: currentUserId
            };

            try {
                const response = await fetch(`${API_URL}/api/projects/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    alert('Proje ba≈üarƒ±yla olu≈üturuldu!');
                    e.target.reset();
                    loadProjects();
                } else {
                    alert('Hata olu≈ütu: ' + (await response.text()));
                }
            } catch (error) {
                alert('Baƒülantƒ± hatasƒ±: ' + error.message);
            }
        });

        document.getElementById('experiment-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                project_id: parseInt(document.getElementById('experiment-project').value),
                title: document.getElementById('experiment-title').value,
                description: document.getElementById('experiment-description').value,
                tags: document.getElementById('experiment-tags').value.split(',').map(t => t.trim()).filter(t => t)
            };

            try {
                const response = await fetch(`${API_URL}/api/experiments/?user_id=${currentUserId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    alert('Deney ba≈üarƒ±yla olu≈üturuldu!');
                    e.target.reset();
                    loadExperiments();
                } else {
                    alert('Hata olu≈ütu: ' + (await response.text()));
                }
            } catch (error) {
                alert('Baƒülantƒ± hatasƒ±: ' + error.message);
            }
        });

        document.getElementById('entry-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                experiment_id: parseInt(document.getElementById('entry-experiment').value),
                author_id: currentUserId,
                title: document.getElementById('entry-title').value,
                body_md: document.getElementById('entry-body').value,
                tags: document.getElementById('entry-tags').value.split(',').map(t => t.trim()).filter(t => t)
            };

            try {
                const response = await fetch(`${API_URL}/api/entries/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    alert('Kayƒ±t ba≈üarƒ±yla olu≈üturuldu!');
                    e.target.reset();
                    loadEntries();
                    loadDashboard();
                } else {
                    alert('Hata olu≈ütu: ' + (await response.text()));
                }
            } catch (error) {
                alert('Baƒülantƒ± hatasƒ±: ' + error.message);
            }
        });

        // Initialize
        async function init() {
            // Load saved language preference
            const savedLang = localStorage.getItem('lang');
            if (savedLang) {
                currentLang = savedLang;
            }
            updateLanguage();
            
            await checkApiStatus();
            await loadDashboard();
            await loadProjects();
            setInterval(checkApiStatus, 10000); // Check API every 10 seconds
        }

        init();
    </script>
</body>
</html>
